{"version":3,"file":"code-timer.js","sourceRoot":"","sources":["../../../src/utils/code-timer.ts"],"names":[],"mappings":"AAAA,OAAO,EAAC,IAAI,EAAC,MAAM,sBAAsB,CAAC;AAE1C;IASE,mBAAoB,IAAqB;QAArB,qBAAA,EAAA,aAAqB;QAAzC,iBAUC;QAVmB,SAAI,GAAJ,IAAI,CAAiB;QAPzC,SAAI,GAAW,CAAC,CAAC;QACjB;;;WAGG;QACH,WAAM,GAAW,EAAE,CAAC;QAIlB,IAAI,CAAC,GAAG,CAAC,eAAa,IAAI,CAAC,IAAM,CAAC,CAAC,IAAI,CAAC,UAAA,IAAI;YAC1C,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC;gBAAC,MAAM,CAAC;YAClB,IAAI,MAAM,GAAG,CAAC,IAAI,GAAG,IAAI,IAAI,EAAE,CAAC,OAAO,EAAE,CAAC,GAAG,IAAI,GAAG,CAAC,CAAC;YACtD,EAAE,CAAC,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC;gBACf,KAAI,CAAC,IAAI,GAAG,MAAM,CAAC;gBACnB,KAAI,CAAC,QAAQ,EAAE,CAAC;YAClB,CAAC;QACH,CAAC,CAAC,CAAA;IACJ,CAAC;IAED,OAAO;IACP,4BAAQ,GAAR;QAAA,iBAUC;QARC,EAAE,CAAC,CAAC,IAAI,CAAC,IAAI,IAAI,CAAC,CAAC;YACjB,IAAI,CAAC,IAAI,GAAG,EAAE,CAAC;QACjB,UAAU,CAAC;YACT,KAAI,CAAC,IAAI,EAAE,CAAC;YACZ,EAAE,CAAC,CAAC,KAAI,CAAC,IAAI,GAAG,CAAC,CAAC,CAAC,CAAC;gBAClB,KAAI,CAAC,QAAQ,EAAE,CAAC;YAClB,CAAC;QACH,CAAC,EAAE,IAAI,CAAC,CAAA;IACV,CAAC;IAED;;OAEG;IACH,8BAAU,GAAV;QAEE,IAAI,CAAC,GAAG,CAAC,eAAa,IAAI,CAAC,IAAM,EAAE,IAAI,IAAI,EAAE,CAAC,OAAO,EAAE,GAAG,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,CAAC,IAAI,EAAE,CAAA;IACpF,CAAC;IACH,gBAAC;AAAD,CAAC,AAzCD,IAyCC","sourcesContent":["import {Data} from \"../ion-wechat.module\";\n\nexport class CodeTimer\n{\n  wait: number = 0;\n  /**\n   * 等待间隔(s)，默认60\n   * @type {number}\n   */\n  during: number = 60;\n\n  constructor(public  type: string = \"code\")\n  {\n    Data.get(`code:wait:${this.type}`).then(wait => {\n      if (!wait) return;\n      let remain = (wait - new Date().getTime()) / 1000 | 0;\n      if (remain > 0) {\n        this.wait = remain;\n        this.intoWait();\n      }\n    })\n  }\n\n  // 进入等待\n  intoWait()\n  {\n    if (this.wait == 0)\n      this.wait = 60;\n    setTimeout(() => {\n      this.wait--;\n      if (this.wait > 0) {\n        this.intoWait();\n      }\n    }, 1000)\n  }\n\n  /**\n   * 在 ionWillUnload 方法中调用\n   */\n  saveStatus()\n  {\n    Data.set(`code:wait:${this.type}`, new Date().getTime() + this.wait * 1000).then()\n  }\n}"]}